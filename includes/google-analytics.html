<!-- Google Analytics 4 (GA4) -->
<!-- Replace G-XXXXXXXXXX with your actual GA4 Measurement ID -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XXXXXXXXXX', {
    'page_title': document.title,
    'page_location': window.location.href,
    'page_path': window.location.pathname,
    'send_page_view': true
  });

  // Event Tracking Functions
  
  // Track WhatsApp button clicks
  document.addEventListener('DOMContentLoaded', function() {
    const whatsappButtons = document.querySelectorAll('.whatsapp-float, a[href*="wa.me"]');
    whatsappButtons.forEach(function(btn) {
      btn.addEventListener('click', function() {
        gtag('event', 'click', {
          'event_category': 'engagement',
          'event_label': 'WhatsApp Contact',
          'value': 1
        });
      });
    });

    // Track product clicks
    const productItems = document.querySelectorAll('.product-item, .product-card');
    productItems.forEach(function(item) {
      item.addEventListener('click', function() {
        const productName = this.querySelector('h3, h4, .product-title')?.textContent || 'Unknown Product';
        gtag('event', 'select_item', {
          'event_category': 'products',
          'event_label': productName,
          'items': [{
            'item_name': productName
          }]
        });
      });
    });

    // Track form submissions
    const forms = document.querySelectorAll('form');
    forms.forEach(function(form) {
      form.addEventListener('submit', function(e) {
        const formName = this.id || this.className || 'contact_form';
        gtag('event', 'form_submit', {
          'event_category': 'contact',
          'event_label': formName,
          'value': 1
        });
      });
    });

    // Track outbound links
    const outboundLinks = document.querySelectorAll('a[href^="http"]:not([href*="tidemaster.ae"])');
    outboundLinks.forEach(function(link) {
      link.addEventListener('click', function() {
        gtag('event', 'click', {
          'event_category': 'outbound',
          'event_label': this.href,
          'transport_type': 'beacon'
        });
      });
    });

    // Track phone number clicks
    const phoneLinks = document.querySelectorAll('a[href^="tel:"]');
    phoneLinks.forEach(function(link) {
      link.addEventListener('click', function() {
        gtag('event', 'click', {
          'event_category': 'engagement',
          'event_label': 'Phone Call',
          'value': 1
        });
      });
    });

    // Track email clicks
    const emailLinks = document.querySelectorAll('a[href^="mailto:"]');
    emailLinks.forEach(function(link) {
      link.addEventListener('click', function() {
        gtag('event', 'click', {
          'event_category': 'engagement',
          'event_label': 'Email',
          'value': 1
        });
      });
    });

    // Track scroll depth
    let scrollTracked = {25: false, 50: false, 75: false, 100: false};
    window.addEventListener('scroll', function() {
      const scrollPercent = Math.round((window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100);
      
      Object.keys(scrollTracked).forEach(function(milestone) {
        if (scrollPercent >= milestone && !scrollTracked[milestone]) {
          scrollTracked[milestone] = true;
          gtag('event', 'scroll', {
            'event_category': 'engagement',
            'event_label': milestone + '%',
            'value': parseInt(milestone)
          });
        }
      });
    });

    // Track video plays (if you have videos)
    const videos = document.querySelectorAll('video');
    videos.forEach(function(video) {
      video.addEventListener('play', function() {
        gtag('event', 'video_play', {
          'event_category': 'video',
          'event_label': this.src || 'embedded_video',
          'value': 1
        });
      });
    });

    // Track time on page
    let timeOnPage = 0;
    setInterval(function() {
      timeOnPage += 10; // Track every 10 seconds
      if (timeOnPage % 30 === 0) { // Report every 30 seconds
        gtag('event', 'timing_complete', {
          'event_category': 'engagement',
          'event_label': 'time_on_page',
          'value': timeOnPage
        });
      }
    }, 10000);
  });
</script>

<!-- INSTRUCTIONS FOR IMPLEMENTATION -->
<!-- 
  1. Get your GA4 Measurement ID:
     - Go to https://analytics.google.com/
     - Create a new GA4 property or use existing one
     - Get your Measurement ID (format: G-XXXXXXXXXX)
     - Replace all instances of 'G-XXXXXXXXXX' with your actual ID

  2. Add this file to all your HTML pages in the <head> section:
     Add this line after the <meta> tags and before closing </head>:
     
     <?php include 'includes/google-analytics.html'; ?>
     
     Or if not using PHP, copy the entire content of this file into each page's <head>

  3. Verify installation:
     - Open your website in a browser
     - Open Google Analytics Real-time reports
     - You should see your visit in real-time

  4. Events being tracked automatically:
     - Page views
     - WhatsApp button clicks
     - Product clicks
     - Form submissions
     - Outbound link clicks
     - Phone number clicks
     - Email clicks
     - Scroll depth (25%, 50%, 75%, 100%)
     - Video plays
     - Time on page

  5. Test your events:
     - Open Chrome DevTools (F12)
     - Go to Network tab
     - Filter by "google-analytics.com" or "collect"
     - Click various elements and watch events fire

  6. Google Search Console Integration:
     - Go to https://search.google.com/search-console
     - Add your property (www.tidemaster.ae)
     - Verify ownership (DNS, HTML file, or GA)
     - Link GA4 with Search Console in Admin settings
-->
